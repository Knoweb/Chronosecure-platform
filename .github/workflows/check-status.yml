name: Check Server Status

on:
  workflow_dispatch: # Allows manual trigger

jobs:
  check-status:
    runs-on: ubuntu-latest
    steps:
    - name: Check Containers & Logs
      uses: appleboy/ssh-action@master
      with:
        host: ${{ secrets.DO_HOST }}
        username: ${{ secrets.DO_USERNAME }}
        key: ${{ secrets.DO_SSH_KEY }}
        script: |
          echo "=== DOCKER PS (Running Containers) ==="
          docker ps
          
          echo "=== DOCKER PS -A (All Containers) ==="
          docker ps -a
          
          echo "=== BACKEND LOGS (Last 50 lines) ==="
          docker logs --tail 50 chronosecure-backend || echo "Backend container not found"
          
          echo "=== FRONTEND LOGS (Last 50 lines) ==="
          docker logs --tail 50 chronosecure-frontend || echo "Frontend container not found"
          
          echo "=== DB LOGS (Last 20 lines) ==="
          docker logs --tail 20 chronosecure-db || echo "DB container not found"
